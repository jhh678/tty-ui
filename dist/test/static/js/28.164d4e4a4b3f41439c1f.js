webpackJsonp([28],{751:function(e,n,r){n=e.exports=r(530)(!1),n.push([e.i,".btnbox[data-v-539f5330]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.marginbtn[data-v-539f5330]{margin-right:10px}",""])},781:function(e,n,r){r(841);var t=r(33)(r(880),r(805),"data-v-539f5330",null);t.options.__file="E:\\workspace\\Git\\console.cloud.ttyun.com\\src\\views\\basic-data\\sys-user\\add-edit.vue",t.esModule&&Object.keys(t.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),t.options.functional&&console.error("[vue-loader] add-edit.vue: functional components are not supported with templates, they should use render functions."),e.exports=t.exports},805:function(e,n,r){e.exports={render:function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",[r("b-form",{ref:"ruleForm",staticClass:"demo-form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("b-form-item",{attrs:{label:"用户名",prop:"name"}},[r("b-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(n){e.ruleForm.name=n},expression:"ruleForm.name"}})],1),e._v(" "),0==e.isEdit?r("b-form-item",{attrs:{label:"密码",prop:"password"}},[r("b-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.ruleForm.password,callback:function(n){e.ruleForm.password=n},expression:"ruleForm.password"}})],1):e._e(),e._v(" "),0==e.isEdit?r("b-form-item",{attrs:{label:"确认密码",prop:"cpassword"}},[r("b-input",{attrs:{type:"password",placeholder:"请输确认密码"},model:{value:e.ruleForm.cpassword,callback:function(n){e.ruleForm.cpassword=n},expression:"ruleForm.cpassword"}})],1):e._e(),e._v(" "),r("b-form-item",{attrs:{label:"姓名",prop:"username"}},[r("b-select",{attrs:{placeholder:"请选择职员"},on:{change:e.selectUser},model:{value:e.ruleForm.username,callback:function(n){e.ruleForm.username=n},expression:"ruleForm.username"}},e._l(e.employee,function(n,t){return r("b-option",{key:t,attrs:{label:n.emp_name,value:n.emp_id}},[e._v(e._s(n.emp_name+" | "+n.dept_name+" | "+n.emp_mobile))])}))],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPhone,expression:"showPhone"}]},[r("b-form-item",{attrs:{label:"手机号"}},[r("b-input",{attrs:{disabled:""},model:{value:e.ruleForm.phone,callback:function(n){e.ruleForm.phone=n},expression:"ruleForm.phone"}})],1),e._v(" "),r("b-form-item",{attrs:{label:"部门"}},[r("b-input",{attrs:{disabled:""},model:{value:e.ruleForm.part,callback:function(n){e.ruleForm.part=n},expression:"ruleForm.part"}})],1)],1),e._v(" "),r("b-form-item",{attrs:{label:"角色",prop:"role",widthauto:!0}},[r("b-checkbox-group",{attrs:{type:"button",tips:"至少选择一种角色"},model:{value:e.ruleForm.role,callback:function(n){e.ruleForm.role=n},expression:"ruleForm.role"}},e._l(e.userRole,function(n,t){return r("b-checkbox",{key:t,attrs:{label:n.id,name:n.name}},[e._v(e._s(n.name))])}))],1),e._v(" "),0==e.isEdit?r("div",{staticClass:"btnbox"},[r("button",{staticClass:"btn btn-mw btn-primary marginbtn",attrs:{type:"button"},on:{click:function(n){e.addSubmitForm(1)}}},[e._v("保存并关闭")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default marginbtn",attrs:{type:"button"},on:{click:function(n){e.addSubmitForm(0)}}},[e._v("保存并新增")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("取消")])]):r("div",{staticClass:"btnbox"},[r("button",{staticClass:"btn btn-mw btn-primary marginbtn",attrs:{type:"button"},on:{click:function(n){e.editSubmitForm()}}},[e._v("保存")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("取消")])])],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},841:function(e,n,r){var t=r(751);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);r(531)("7c0aec24",t,!1)},880:function(e,n,r){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(94),o=t(l),i=r(93),s=t(i),a=r(92),m=t(a),A=function(){var e="E:\\workspace\\Git\\console.cloud.ttyun.com\\src\\views\\basic-data\\sys-user\\add-edit.vue",n="826159fdfe55eabce702f4f5cd182a61c4d29cf0",r=new Function("return this")(),t="__coverage__",l={path:"E:\\workspace\\Git\\console.cloud.ttyun.com\\src\\views\\basic-data\\sys-user\\add-edit.vue",statementMap:{0:{start:{line:80,column:4},end:{line:133,column:5}},1:{start:{line:108,column:12},end:{line:114,column:13}},2:{start:{line:109,column:14},end:{line:109,column:43}},3:{start:{line:110,column:18},end:{line:114,column:13}},4:{start:{line:111,column:14},end:{line:111,column:47}},5:{start:{line:113,column:14},end:{line:113,column:24}},6:{start:{line:137,column:25},end:{line:137,column:49}},7:{start:{line:142,column:6},end:{line:147,column:8}},8:{start:{line:143,column:8},end:{line:146,column:9}},9:{start:{line:144,column:10},end:{line:144,column:27}},10:{start:{line:145,column:10},end:{line:145,column:28}},11:{start:{line:150,column:6},end:{line:154,column:8}},12:{start:{line:151,column:8},end:{line:153,column:9}},13:{start:{line:152,column:10},end:{line:152,column:25}},14:{start:{line:157,column:6},end:{line:157,column:39}},15:{start:{line:160,column:17},end:{line:160,column:65}},16:{start:{line:160,column:46},end:{line:160,column:64}},17:{start:{line:161,column:6},end:{line:161,column:26}},18:{start:{line:162,column:6},end:{line:167,column:7}},19:{start:{line:163,column:8},end:{line:163,column:45}},20:{start:{line:164,column:8},end:{line:164,column:43}},21:{start:{line:165,column:8},end:{line:165,column:38}},22:{start:{line:166,column:8},end:{line:166,column:29}},23:{start:{line:171,column:6},end:{line:171,column:22}},24:{start:{line:172,column:6},end:{line:172,column:25}},25:{start:{line:176,column:26},end:{line:181,column:7}},26:{start:{line:182,column:16},end:{line:182,column:72}},27:{start:{line:183,column:6},end:{line:183,column:31}},28:{start:{line:187,column:18},end:{line:195,column:7}},29:{start:{line:196,column:16},end:{line:196,column:63}},30:{start:{line:197,column:6},end:{line:200,column:7}},31:{start:{line:198,column:8},end:{line:198,column:37}},32:{start:{line:199,column:8},end:{line:199,column:24}},33:{start:{line:204,column:6},end:{line:204,column:30}},34:{start:{line:205,column:6},end:{line:205,column:33}},35:{start:{line:206,column:6},end:{line:206,column:22}},36:{start:{line:207,column:17},end:{line:207,column:31}},37:{start:{line:208,column:6},end:{line:208,column:45}},38:{start:{line:209,column:6},end:{line:209,column:34}},39:{start:{line:210,column:6},end:{line:210,column:45}},40:{start:{line:211,column:6},end:{line:215,column:7}},41:{start:{line:212,column:8},end:{line:214,column:10}},42:{start:{line:213,column:10},end:{line:213,column:42}},43:{start:{line:219,column:6},end:{line:219,column:37}},44:{start:{line:220,column:18},end:{line:228,column:7}},45:{start:{line:229,column:6},end:{line:229,column:24}},46:{start:{line:230,column:16},end:{line:230,column:66}},47:{start:{line:231,column:6},end:{line:234,column:7}},48:{start:{line:232,column:8},end:{line:232,column:37}},49:{start:{line:233,column:8},end:{line:233,column:24}},50:{start:{line:238,column:4},end:{line:238,column:22}}},fnMap:{0:{name:"(anonymous_0)",decl:{start:{line:107,column:21},end:{line:107,column:22}},loc:{start:{line:107,column:48},end:{line:115,column:11}},line:107},1:{name:"(anonymous_1)",decl:{start:{line:137,column:16},end:{line:137,column:17}},loc:{start:{line:137,column:25},end:{line:137,column:49}},line:137},2:{name:"(anonymous_2)",decl:{start:{line:142,column:35},end:{line:142,column:36}},loc:{start:{line:142,column:44},end:{line:147,column:7}},line:142},3:{name:"(anonymous_3)",decl:{start:{line:150,column:35},end:{line:150,column:36}},loc:{start:{line:150,column:44},end:{line:154,column:7}},line:150},4:{name:"(anonymous_4)",decl:{start:{line:160,column:38},end:{line:160,column:39}},loc:{start:{line:160,column:46},end:{line:160,column:64}},line:160},5:{name:"(anonymous_5)",decl:{start:{line:212,column:27},end:{line:212,column:28}},loc:{start:{line:212,column:35},end:{line:214,column:9}},line:212}},branchMap:{0:{loc:{start:{line:108,column:12},end:{line:114,column:13}},type:"if",locations:[{start:{line:108,column:12},end:{line:114,column:13}},{start:{line:108,column:12},end:{line:114,column:13}}],line:108},1:{loc:{start:{line:110,column:18},end:{line:114,column:13}},type:"if",locations:[{start:{line:110,column:18},end:{line:114,column:13}},{start:{line:110,column:18},end:{line:114,column:13}}],line:110},2:{loc:{start:{line:143,column:8},end:{line:146,column:9}},type:"if",locations:[{start:{line:143,column:8},end:{line:146,column:9}},{start:{line:143,column:8},end:{line:146,column:9}}],line:143},3:{loc:{start:{line:151,column:8},end:{line:153,column:9}},type:"if",locations:[{start:{line:151,column:8},end:{line:153,column:9}},{start:{line:151,column:8},end:{line:153,column:9}}],line:151},4:{loc:{start:{line:161,column:13},end:{line:161,column:26}},type:"binary-expr",locations:[{start:{line:161,column:13},end:{line:161,column:20}},{start:{line:161,column:24},end:{line:161,column:26}}],line:161},5:{loc:{start:{line:162,column:6},end:{line:167,column:7}},type:"if",locations:[{start:{line:162,column:6},end:{line:167,column:7}},{start:{line:162,column:6},end:{line:167,column:7}}],line:162},6:{loc:{start:{line:197,column:6},end:{line:200,column:7}},type:"if",locations:[{start:{line:197,column:6},end:{line:200,column:7}},{start:{line:197,column:6},end:{line:200,column:7}}],line:197},7:{loc:{start:{line:197,column:10},end:{line:197,column:40}},type:"binary-expr",locations:[{start:{line:197,column:10},end:{line:197,column:26}},{start:{line:197,column:30},end:{line:197,column:40}}],line:197},8:{loc:{start:{line:211,column:6},end:{line:215,column:7}},type:"if",locations:[{start:{line:211,column:6},end:{line:215,column:7}},{start:{line:211,column:6},end:{line:215,column:7}}],line:211},9:{loc:{start:{line:231,column:6},end:{line:234,column:7}},type:"if",locations:[{start:{line:231,column:6},end:{line:234,column:7}},{start:{line:231,column:6},end:{line:234,column:7}}],line:231}},s:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0,41:0,42:0,43:0,44:0,45:0,46:0,47:0,48:0,49:0,50:0},f:{0:0,1:0,2:0,3:0,4:0,5:0},b:{0:[0,0],1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0],8:[0,0],9:[0,0]},inputSourceMap:{version:3,sources:["add-edit.vue?19bc2dbc"],names:[],mappings:";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",sourcesContent:['<template>\r\n  <div>\r\n    <b-form :model="ruleForm" :rules="rules" ref="ruleForm" label-width="80px" class="demo-form">\r\n      <b-form-item label="用户名" prop="name">\r\n        <b-input v-model="ruleForm.name" placeholder="请输入用户名"></b-input>\r\n      </b-form-item>\r\n      <b-form-item label="密码" prop="password" v-if="isEdit == 0">\r\n        <b-input type="password" v-model="ruleForm.password"  placeholder="请输入密码"></b-input>\r\n      </b-form-item>\r\n      <b-form-item label="确认密码" prop="cpassword" v-if="isEdit == 0">\r\n        <b-input  type="password" v-model="ruleForm.cpassword"  placeholder="请输确认密码"></b-input>\r\n      </b-form-item>\r\n      <b-form-item label="姓名" prop="username">\r\n        <b-select v-model="ruleForm.username" placeholder="请选择职员" @change="selectUser">\r\n          <b-option v-for="(item, index) in employee" :key="index" \r\n                    :label="item.emp_name" \r\n                    :value="item.emp_id">{{item.emp_name + \' | \' + item.dept_name + \' | \' + item.emp_mobile}}</b-option>\r\n        </b-select>\r\n      </b-form-item>\r\n      <div v-show="showPhone">\r\n        <b-form-item label="手机号">\r\n          <b-input v-model="ruleForm.phone" disabled></b-input>\r\n        </b-form-item>\r\n        <b-form-item label="部门">\r\n          <b-input v-model="ruleForm.part"  disabled></b-input>\r\n        </b-form-item>\r\n      </div>\r\n      <b-form-item label="角色" prop="role" :widthauto="true">\r\n        <b-checkbox-group v-model="ruleForm.role" type="button" tips="至少选择一种角色">\r\n          <b-checkbox v-for="(role, index) in userRole" \r\n                      :label="role.id"\r\n                      :name="role.name"\r\n                      :key="index">{{role.name}}</b-checkbox>\r\n        </b-checkbox-group>\r\n      </b-form-item>\r\n      <div class="btnbox" v-if="isEdit == 0">\r\n        <button type="button" class="btn btn-mw btn-primary marginbtn" @click="addSubmitForm(1)">保存并关闭</button>\r\n        <button type="button" class="btn btn-mw btn-default marginbtn" @click="addSubmitForm(0)">保存并新增</button>\r\n        <button type="button" class="btn btn-mw btn-default" @click="cancel">取消</button>\r\n      </div>\r\n      <div class="btnbox" v-else>\r\n        <button type="button" class="btn btn-mw btn-primary marginbtn" @click="editSubmitForm()">保存</button>\r\n        <button type="button" class="btn btn-mw btn-default" @click="cancel">取消</button>\r\n      </div>\r\n    </b-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \'vuex\'\r\nimport { BForm, BFormItem } from \'@/components/form\'\r\nimport BInput from \'@/components/input\'\r\nimport { BSelect, BOption, BOptionGroup } from \'@/components/select\'\r\nimport BTable from \'@/components/table/table\'\r\nimport BCheckbox from \'@/components/checkbox/checkbox\'\r\nimport BCheckboxGroup from \'@/components/checkbox/checkbox-group\'\r\nexport default {\r\n  components: {\r\n    BForm,\r\n    BFormItem,\r\n    BInput,\r\n    BSelect,\r\n    BOption,\r\n    BOptionGroup,\r\n    BTable,\r\n    BCheckbox,\r\n    BCheckboxGroup\r\n  },\r\n  props: {\r\n    isEdit: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    editeData: {\r\n      type: Object,\r\n      default: {}\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      ruleForm: {\r\n        name: \'\',\r\n        password: \'\',\r\n        cpassword: \'\',\r\n        username: \'\',\r\n        phone: \'\',\r\n        part: \'\',\r\n        role: [\'\']\r\n      },\r\n      rules: {\r\n        name: [{\r\n          required: true,\r\n          message: \'请输入用户名\',\r\n          trigger: \'blur\'\r\n        }],\r\n        password: [{\r\n          required: true,\r\n          message: \'请输入密码\',\r\n          trigger: \'blur\'\r\n        }, {\r\n          min: 6,\r\n          message: \'密码长度至少为6个字符\',\r\n          trigger: \'blur\'\r\n        }],\r\n        cpassword: [{\r\n          required: true,\r\n          validator: (rule, value, callback) => {\r\n            if (value === \'\') {\r\n              callback(new Error(\'请输确认密码\'))\r\n            }else if (value !== this.ruleForm.password) {\r\n              callback(new Error(\'两次输入密码不一致!\'))\r\n            }else {\r\n              callback()\r\n            }\r\n          },\r\n          trigger: \'blur\'\r\n        }],\r\n        username: [{\r\n          required: true,\r\n          message: \'请选择姓名\',\r\n          trigger: \'change\'\r\n        }],\r\n        role: [{\r\n          type: \'array\',\r\n          required: true,\r\n          message: \'至少选择一种角色\',\r\n          trigger: \'blur\'\r\n        }]\r\n      },\r\n      employee: [],\r\n      selectEmpid: \'\',\r\n      showPhone: false\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      userRole: state => state.BasicData.userRole\r\n    })\r\n  },\r\n  methods: {\r\n    addSubmitForm (type) {\r\n      this.$refs.ruleForm.validate(valid => {\r\n        if (valid) {\r\n          console.log(\'成功\')\r\n          this.addUser(type)\r\n        }\r\n      })\r\n    },\r\n    editSubmitForm () {\r\n      this.$refs.ruleForm.validate(valid => {\r\n        if (valid) {\r\n          this.editUser()\r\n        }\r\n      })\r\n    },\r\n    resetForm() {\r\n      this.$refs.ruleForm.resetFields()\r\n    },\r\n    selectUser (id) {\r\n      let item = this.employee.filter(item => item.emp_id === id)\r\n      item = item[0] || {}\r\n      if (item.emp_id) {\r\n        this.ruleForm.phone = item.emp_mobile\r\n        this.ruleForm.part = item.dept_name\r\n        this.selectEmpid = item.emp_id\r\n        this.showPhone = true\r\n      }\r\n    },\r\n    // 取消\r\n    cancel () {\r\n      this.resetForm()\r\n      this.$emit(\'close\')\r\n    },\r\n    // 获取职员列表\r\n    async getEmployee () {\r\n      let employeePrams = {\r\n        org_id: \'141861443334111232\',\r\n        page: 1,\r\n        keyword: \'\',\r\n        limit: 9999\r\n      }\r\n      let res = await this.$store.dispatch(\'getEmployee\', employeePrams)\r\n      this.employee = res.items\r\n    },\r\n    // 新增用户\r\n    async addUser (type) {\r\n      let prams = {\r\n        org_id: \'141861443334111232\', // 先写死一个 id\r\n        login_account: this.ruleForm.name,\r\n        login_password: this.ruleForm.password,\r\n        full_name: this.ruleForm.username,\r\n        role_ids: this.ruleForm.role.join(\',\'),\r\n        emp_id: this.selectEmpid,\r\n        status: 1\r\n      }\r\n      let res = await this.$store.dispatch(\'addSysUser\', prams)\r\n      if (res.code === 200 && type === 1) {\r\n        this.$emit(\'close\', \'新增用户成功\')\r\n        this.resetForm()\r\n      }\r\n    },\r\n    // 初始化编辑数据\r\n    initEdit () {\r\n      console.log(this.isEdit)\r\n      console.log(this.editeData)\r\n      this.resetForm()\r\n      let data = this.editeData\r\n      this.ruleForm.username = data.full_name\r\n      this.selectUser(data.emp_id)\r\n      this.ruleForm.name = data.login_account\r\n      if (data.roles.length > 0) {\r\n        data.roles.forEach(item => {\r\n          this.ruleForm.role.push(item.id)\r\n        })\r\n      }\r\n    },\r\n    // 编辑用户\r\n    async editUser () {\r\n      console.log(this.ruleForm.role)\r\n      let prams = {\r\n        id: this.editeData.user_id,\r\n        org_id: \'141861443334111232\', // 先写死一个 id\r\n        login_account: this.ruleForm.name,\r\n        full_name: this.ruleForm.username,\r\n        role_ids: this.ruleForm.role.join(\',\').substr(1),\r\n        emp_id: this.selectEmpid,\r\n        status: this.editeData.status\r\n      }\r\n      console.log(prams)\r\n      let res = await this.$store.dispatch(\'updateSysUser\', prams)\r\n      if (res.code === 200) {\r\n        this.$emit(\'close\', \'修改用户成功\')\r\n        this.resetForm()\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.getEmployee()\r\n  }\r\n}\r\n<\/script>\r\n\r\n<style lang="scss" scoped>\r\n.btnbox{\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n.marginbtn{\r\n  margin-right: 10px;\r\n}\r\n</style>']},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},o=r[t]||(r[t]={});return o[e]&&o[e].hash===n?o[e]:(l.hash=n,o[e]=l)}(),u=r(208),c=r(601),d=r(203),p=t(d),b=r(568),C=r(637),f=t(C),h=r(566),v=t(h),F=r(575),y=t(F);n.default={components:{BForm:c.BForm,BFormItem:c.BFormItem,BInput:p.default,BSelect:b.BSelect,BOption:b.BOption,BOptionGroup:b.BOptionGroup,BTable:f.default,BCheckbox:v.default,BCheckboxGroup:y.default},props:{isEdit:{type:Number,default:0},editeData:{type:Object,default:{}}},data:function(){var e=this;return A.s[0]++,{ruleForm:{name:"",password:"",cpassword:"",username:"",phone:"",part:"",role:[""]},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}],cpassword:[{required:!0,validator:function(n,r,t){A.f[0]++,A.s[1]++,""===r?(A.b[0][0]++,A.s[2]++,t(new Error("请输确认密码"))):(A.b[0][1]++,A.s[3]++,r!==e.ruleForm.password?(A.b[1][0]++,A.s[4]++,t(new Error("两次输入密码不一致!"))):(A.b[1][1]++,A.s[5]++,t()))},trigger:"blur"}],username:[{required:!0,message:"请选择姓名",trigger:"change"}],role:[{type:"array",required:!0,message:"至少选择一种角色",trigger:"blur"}]},employee:[],selectEmpid:"",showPhone:!1}},computed:(0,m.default)({},(0,u.mapState)({userRole:function(e){return A.f[1]++,A.s[6]++,e.BasicData.userRole}})),methods:{addSubmitForm:function(e){var n=this;A.s[7]++,this.$refs.ruleForm.validate(function(r){A.f[2]++,A.s[8]++,r?(A.b[2][0]++,A.s[9]++,console.log("成功"),A.s[10]++,n.addUser(e)):A.b[2][1]++})},editSubmitForm:function(){var e=this;A.s[11]++,this.$refs.ruleForm.validate(function(n){A.f[3]++,A.s[12]++,n?(A.b[3][0]++,A.s[13]++,e.editUser()):A.b[3][1]++})},resetForm:function(){A.s[14]++,this.$refs.ruleForm.resetFields()},selectUser:function(e){var n=(A.s[15]++,this.employee.filter(function(n){return A.f[4]++,A.s[16]++,n.emp_id===e}));A.s[17]++,A.b[4][0]++,n=n[0]||(A.b[4][1]++,{}),A.s[18]++,n.emp_id?(A.b[5][0]++,A.s[19]++,this.ruleForm.phone=n.emp_mobile,A.s[20]++,this.ruleForm.part=n.dept_name,A.s[21]++,this.selectEmpid=n.emp_id,A.s[22]++,this.showPhone=!0):A.b[5][1]++},cancel:function(){A.s[23]++,this.resetForm(),A.s[24]++,this.$emit("close")},getEmployee:function(){var e=this;return(0,s.default)(o.default.mark(function n(){var r,t;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return A.s[25]++,r={org_id:"141861443334111232",page:1,keyword:"",limit:9999},A.s[26]++,n.next=4,e.$store.dispatch("getEmployee",r);case 4:t=n.sent,A.s[27]++,e.employee=t.items;case 7:case"end":return n.stop()}},n,e)}))()},addUser:function(e){var n=this;return(0,s.default)(o.default.mark(function r(){var t,l;return o.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return A.s[28]++,t={org_id:"141861443334111232",login_account:n.ruleForm.name,login_password:n.ruleForm.password,full_name:n.ruleForm.username,role_ids:n.ruleForm.role.join(","),emp_id:n.selectEmpid,status:1},A.s[29]++,r.next=4,n.$store.dispatch("addSysUser",t);case 4:l=r.sent,A.s[30]++,A.b[7][0]++,200===l.code&&(A.b[7][1]++,1===e)?(A.b[6][0]++,A.s[31]++,n.$emit("close","新增用户成功"),A.s[32]++,n.resetForm()):A.b[6][1]++;case 7:case"end":return r.stop()}},r,n)}))()},initEdit:function(){var e=this;A.s[33]++,console.log(this.isEdit),A.s[34]++,console.log(this.editeData),A.s[35]++,this.resetForm();var n=(A.s[36]++,this.editeData);A.s[37]++,this.ruleForm.username=n.full_name,A.s[38]++,this.selectUser(n.emp_id),A.s[39]++,this.ruleForm.name=n.login_account,A.s[40]++,n.roles.length>0?(A.b[8][0]++,A.s[41]++,n.roles.forEach(function(n){A.f[5]++,A.s[42]++,e.ruleForm.role.push(n.id)})):A.b[8][1]++},editUser:function(){var e=this;return(0,s.default)(o.default.mark(function n(){var r,t;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return A.s[43]++,console.log(e.ruleForm.role),A.s[44]++,r={id:e.editeData.user_id,org_id:"141861443334111232",login_account:e.ruleForm.name,full_name:e.ruleForm.username,role_ids:e.ruleForm.role.join(",").substr(1),emp_id:e.selectEmpid,status:e.editeData.status},A.s[45]++,console.log(r),A.s[46]++,n.next=8,e.$store.dispatch("updateSysUser",r);case 8:t=n.sent,A.s[47]++,200===t.code?(A.b[9][0]++,A.s[48]++,e.$emit("close","修改用户成功"),A.s[49]++,e.resetForm()):A.b[9][1]++;case 11:case"end":return n.stop()}},n,e)}))()}},created:function(){A.s[50]++,this.getEmployee()}}}});
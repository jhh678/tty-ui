webpackJsonp([49],{795:function(e,t,r){t=e.exports=r(536)(!1),t.push([e.i,".btnbox[data-v-e06e9a6e]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.marginbtn[data-v-e06e9a6e]{margin-right:10px}",""])},808:function(e,t,r){r(901);var o=r(32)(r(920),r(861),"data-v-e06e9a6e",null);e.exports=o.exports},861:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-form",{ref:"ruleForm",staticClass:"demo-form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("b-form-item",{attrs:{label:"用户名",prop:"name"}},[r("b-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),0==e.isEdit?r("b-form-item",{attrs:{label:"密码",prop:"password"}},[r("b-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1):e._e(),e._v(" "),0==e.isEdit?r("b-form-item",{attrs:{label:"确认密码",prop:"cpassword"}},[r("b-input",{attrs:{type:"password",placeholder:"请输确认密码"},model:{value:e.ruleForm.cpassword,callback:function(t){e.$set(e.ruleForm,"cpassword",t)},expression:"ruleForm.cpassword"}})],1):e._e(),e._v(" "),r("b-form-item",{attrs:{label:"姓名",prop:"username"}},[r("b-select",{attrs:{placeholder:"请选择职员"},on:{change:e.selectUser},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}},e._l(e.employee,function(t,o){return r("b-option",{key:o,attrs:{label:t.emp_name,value:t.emp_id}},[e._v(e._s(t.emp_name+" | "+t.dept_name+" | "+t.emp_mobile))])}))],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showPhone,expression:"showPhone"}]},[r("b-form-item",{attrs:{label:"手机号"}},[r("b-input",{attrs:{disabled:""},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e._v(" "),r("b-form-item",{attrs:{label:"部门"}},[r("b-input",{attrs:{disabled:""},model:{value:e.ruleForm.part,callback:function(t){e.$set(e.ruleForm,"part",t)},expression:"ruleForm.part"}})],1)],1),e._v(" "),r("b-form-item",{attrs:{label:"角色",prop:"role",widthauto:!0}},[r("b-checkbox-group",{attrs:{type:"button",tips:"至少选择一种角色"},model:{value:e.ruleForm.role,callback:function(t){e.$set(e.ruleForm,"role",t)},expression:"ruleForm.role"}},e._l(e.userRole,function(t,o){return r("b-checkbox",{key:o,attrs:{label:t.id,name:t.name}},[e._v(e._s(t.name))])}))],1),e._v(" "),0==e.isEdit?r("div",{staticClass:"btnbox"},[r("button",{staticClass:"btn btn-mw btn-primary marginbtn",attrs:{type:"button"},on:{click:function(t){e.addSubmitForm(1)}}},[e._v("保存并关闭")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default marginbtn",attrs:{type:"button"},on:{click:function(t){e.addSubmitForm(0)}}},[e._v("保存并新增")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("取消")])]):r("div",{staticClass:"btnbox"},[r("button",{staticClass:"btn btn-mw btn-primary marginbtn",attrs:{type:"button"},on:{click:function(t){e.editSubmitForm()}}},[e._v("保存")]),e._v(" "),r("button",{staticClass:"btn btn-mw btn-default",attrs:{type:"button"},on:{click:e.cancel}},[e._v("取消")])])],1)],1)},staticRenderFns:[]}},901:function(e,t,r){var o=r(795);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r(537)("c837a410",o,!0)},920:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(94),s=r.n(o),a=r(93),n=r.n(a),i=r(92),l=r.n(i),u=r(210),m=r(663),c=r(206),p=r(600),d=r(694),b=r.n(d),f=r(597),h=r.n(f),v=r(608),F=r.n(v);t.default={components:{BForm:m.a,BFormItem:m.b,BInput:c.a,BSelect:p.a,BOption:p.b,BOptionGroup:p.c,BTable:b.a,BCheckbox:h.a,BCheckboxGroup:F.a},props:{isEdit:{type:Number,default:0},editeData:{type:Object,default:{}}},data:function(){var e=this;return{ruleForm:{name:"",password:"",cpassword:"",username:"",phone:"",part:"",role:[""]},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}],cpassword:[{required:!0,validator:function(t,r,o){""===r?o(new Error("请输确认密码")):r!==e.ruleForm.password?o(new Error("两次输入密码不一致!")):o()},trigger:"blur"}],username:[{required:!0,message:"请选择姓名",trigger:"change"}],role:[{type:"array",required:!0,message:"至少选择一种角色",trigger:"blur"}]},employee:[],selectEmpid:"",showPhone:!1}},computed:l()({},r.i(u.b)({userRole:function(e){return e.BasicData.userRole}})),methods:{addSubmitForm:function(e){var t=this;this.$refs.ruleForm.validate(function(r){r&&(console.log("成功"),t.addUser(e))})},editSubmitForm:function(){var e=this;this.$refs.ruleForm.validate(function(t){t&&e.editUser()})},resetForm:function(){this.$refs.ruleForm.resetFields()},selectUser:function(e){var t=this.employee.filter(function(t){return t.emp_id===e});t=t[0]||{},t.emp_id&&(this.ruleForm.phone=t.emp_mobile,this.ruleForm.part=t.dept_name,this.selectEmpid=t.emp_id,this.showPhone=!0)},cancel:function(){this.resetForm(),this.$emit("close")},getEmployee:function(){var e=this;return n()(s.a.mark(function t(){var r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={org_id:"141861443334111232",page:1,keyword:"",limit:9999},t.next=3,e.$store.dispatch("getEmployee",r);case 3:o=t.sent,e.employee=o.items;case 5:case"end":return t.stop()}},t,e)}))()},addUser:function(e){var t=this;return n()(s.a.mark(function r(){var o,a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o={org_id:"141861443334111232",login_account:t.ruleForm.name,login_password:t.ruleForm.password,full_name:t.ruleForm.username,role_ids:t.ruleForm.role.join(","),emp_id:t.selectEmpid,status:1},r.next=3,t.$store.dispatch("addSysUser",o);case 3:a=r.sent,200===a.code&&1===e&&(t.$emit("close","新增用户成功"),t.resetForm());case 5:case"end":return r.stop()}},r,t)}))()},initEdit:function(){var e=this;console.log(this.isEdit),console.log(this.editeData),this.resetForm();var t=this.editeData;this.ruleForm.username=t.full_name,this.selectUser(t.emp_id),this.ruleForm.name=t.login_account,t.roles.length>0&&t.roles.forEach(function(t){e.ruleForm.role.push(t.id)})},editUser:function(){var e=this;return n()(s.a.mark(function t(){var r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.ruleForm.role),r={id:e.editeData.user_id,org_id:"141861443334111232",login_account:e.ruleForm.name,full_name:e.ruleForm.username,role_ids:e.ruleForm.role.join(",").substr(1),emp_id:e.selectEmpid,status:e.editeData.status},console.log(r),t.next=5,e.$store.dispatch("updateSysUser",r);case 5:o=t.sent,200===o.code&&(e.$emit("close","修改用户成功"),e.resetForm());case 7:case"end":return t.stop()}},t,e)}))()}},created:function(){this.getEmployee()}}}});